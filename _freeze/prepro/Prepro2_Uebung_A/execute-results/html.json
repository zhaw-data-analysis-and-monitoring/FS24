{
  "hash": "21a01de4bd2a9a422341de26aebda8c9",
  "result": {
    "markdown": "---\ndate: 2023-10-16\nlesson: PrePro2\nthema: Piping / Joins\nindex: 2\nexecute: \n  echo: true   # set to true to show musterlösung\n  output: true # set to true to show musterlösung\ncode-fold: true\ncode-summary: \"Musterlösung\"\nknitr:\n  opts_chunk: \n    collapse: true\n---\n\n\n# Prepro 2: Übung A\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(\"dplyr\")\nlibrary(\"readr\")\nlibrary(\"lubridate\")\n\n# Alternativ kannst du alle tidyverse packages mit library(\"tidyverse\") laden\n```\n:::\n\n\n## Aufgabe 1\n\nLese die Wetterdaten von letzer Woche *weather.csv* (Quelle MeteoSchweiz) in `R` ein. Sorge dafür, dass die Spalten korrekt formatiert sind (`stn` als `factor`, `time` als `POSIXct`, `tre200h0` als `numeric`.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Variante 1\nwetter <- read_delim(\"datasets/prepro/weather.csv\", \",\")\nwetter$stn <- as.factor(wetter$stn)\nwetter$time <- as.POSIXct(as.character(wetter$time), format = \"%Y%m%d%H\", tz = \"UTC\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Variate 2 (für Profis)\nwetter <- read_csv(\"datasets/prepro/weather.csv\",\n  col_types = cols(\n    col_factor(levels = NULL),\n    col_datetime(format = \"%Y%m%d%H\"),\n    col_double()\n  )\n)\n```\n:::\n\n\n## Aufgabe 2\n\nLese den Datensatz *metadata.csv* ebenfalls als csv ein.\n\n:::{.callout-tip}\nWenn Umlaute und Sonderzeichen nicht korrekt dargestellt werden (z.B. das è in Gen*è*ve), hat das vermutlich mit der [Zeichencodierung](https://de.wikipedia.org/wiki/Zeichenkodierung) zu tun. Das File ist aktuell in *UTF-8* codiert. Wenn Umlaute nicht korrekt dargestellt werden, hat R diese Codierung nicht erkannt und sie muss in der Import-Funktion spezifitiert werden. Dies wird je nach verwendete import Funktion unterschiedlich gemacht:\n\n- Funktionen aus dem Package `readr`: `locale = locale(encoding = \"UTF-8\")`\n- Base-R Funktionen: `fileEncoding = \"UTF-8\"`\n\nWenn ihr die codierung eines Files *nicht* kennt, könnt wie folgt vorgehen: Anleitung [für Windows](https://stackoverflow.com/a/13464816/4139249), [für Mac](https://stackoverflow.com/a/2461193/4139249) und [für Linux](https://stackoverflow.com/a/805474/4139249). \n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata <- read_delim(\"datasets/prepro/metadata.csv\", delim = \";\", locale = locale(encoding = \"UTF-8\"))\n```\n:::\n\n\n## Aufgabe 3\n\nNun wollen wir den Datensatz `wetter`mit den Informationen aus `metadata` anreichern. Uns interessiert aber nur das Stationskürzel, der Name, die x/y Koordinaten sowie die Meereshöhe, selektiere diese Spalten.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata <- metadata[, c(\"stn\", \"Name\", \"x\", \"y\", \"Meereshoehe\")]\n```\n:::\n\n\n## Aufgabe 4\n\nJetzt kann `metadata` mit dem Datensatz `wetter` verbunden werden. Überlege dir, welcher Join dafür sinnvoll ist und mit welchem Attribut wir \"joinen\" können.\n\nNutze die Join-Möglichkeiten von `dplyr` (Hilfe via `?dplyr::join`)  um die Datensätze `wetter` und `metadata` zu verbinden.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwetter <- left_join(wetter, metadata, by = \"stn\")\n\n# Jointyp: Left-Join auf 'wetter', da uns nur die Stationen im Datensatz 'wetter' interessieren.\n# Attribut: \"stn\"\n```\n:::\n\n\n## Aufgabe 5\n\nErstelle eine neue Spalte `month` welche den jeweiligen Monat (aus `time`) beinhaltet. Nutze dafür die Funktion `lubridate::month()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwetter$month <- month(wetter$time)\n```\n:::\n\n\n## Aufgabe 6\n\nBerechne mit der Spalte `month` die Durchschnittstemperatur pro Monat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(wetter$tre200h0[wetter$month == 1])\n## [1] -1.963239\nmean(wetter$tre200h0[wetter$month == 2])\n## [1] 0.3552632\nmean(wetter$tre200h0[wetter$month == 3])\n## [1] 2.965054\n\n# usw. für alle 12 Monate\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}